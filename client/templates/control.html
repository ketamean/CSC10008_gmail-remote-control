<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>G-Controller</title>

    <!-- Bootstrap 5.0.2 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    >
  
    <!-- style CSS -->
    <link
      rel="stylesheet"
      href="/static/general.css"
    >
    <link
      rel="stylesheet"
      href="/static/control.css"
    >

    <!-- icon -->
    <link
      rel="icon"
      href="{{ url_for('static', filename='asset/icon.png') }}"
      type="image/x-icon"
    >
  </head>
  <body>
    <main class="round-border" id="main-space">
      <div id="title-bar">
        <!-- class="row" -->
        <div>
          <button type="button" id="back-button" style="border: none; background-color: transparent; display: flex; justify-content: center; padding: 0px;"
            onclick="redirectToLogin()">
            <img
              src="{{ url_for('static', filename='asset/home.png') }}"
              title="Go back to log-in page"
              alt="go-back-to-login"
              style="scale: 1.0;"
            />
          </button>
        </div>

        <div>
          <strong>Remote Controller via Gmail</strong>
        </div>

        <div>
          <!-- <img src="/static/asset/home.png" title="icon-home"/> -->
        </div>
      </div> 

      <div id="workspace">
        <div class="options">
          <center>
            <div class="menu">
              <button type="menu" class="application" onclick="show(this)">Application</button>
              <div class="caret"></div>
              <div class="submenu">
                <button type="button" class="list_apps" onclick="insert(this)">List applications</button>
                <button type="button" class="start_app" onclick="insert(this)">Start an application</button>
              </div>
            </div>
            <button type="button" class="key_logger" onclick="insert(this)">Key logger</button>
            <!--<div class="menu">
              <button type="menu" class="shutdown/logout" onclick="show(this)">Shutdown/Logout</button>
              <div class="caret"></div>
              <div class="submenu">
                <button type="button" class="shut_down" onclick="insert(this)">Shut down</button>
                <button type="button" class="log_out" onclick="insert(this)">Log out</button>
              </div>
            </div>-->
            <div class="menu">
              <button type="menu" class="shutdown/logout" onclick="show(this)">Shutdown/Logout</button>
              <div class="caret"></div>
              <div class="submenu">
                <button type="button" class="shut_down" onclick="insert(this)">Shut down</button>
                <button type="button" class="log_out" onclick="insert(this)">Log out</button>
              </div>
            </div>
            <button type="button" class="screen_capture" onclick="insert(this)">Screenshot</button>
            <button type="button" class="list_processes" onclick="insert(this)">List processes</button>
          </center>
        </div>
        <div id="mail-container" class="round-border" style="z-index: 1;">
          <div class="text-box" id="mail-from-box">
            From: <span id="text-from">{{ client_email }}</span>
          </div>

          <div id="mail-content-and-send-btn">
            
            <!-- <button
              type="button"
              
              onclick="sendMessage()"
            >
              <img
                src=""
                title="Send"
                alt="send-icon"
              />  
              Send
            </button> -->
            <textarea class="text-box" id="mail-content-box" name="msg-content" placeholder="Your command here"></textarea>
            <form action="{{ url_for('send_mail_handler') }}" method="post">
              <input type="submit" id="send-btn" value="Send">
            </form>
          </div>

          <div id="alert-box">
            PLEASE DO-<span style="color: red;">NOT</span>-VIOLATE THE SYNTAX!
          </div>
        </div>
      </div>
    </main>
  </body>
  <script>
    var str="2.5%"
    function redirectToLogin() {
    // remove all commands which have been chosen
    document.getElementById('mail-content-box').innerHTML = ``;

    // redirect to login page
    window.location.href = "{{  url_for('login')  }}";
    }

    function insert(btn)
    {
        const box=document.getElementById('mail-content-box');
        box.value += '[' + btn.className + ']\n';
    }

    function show(btn)
    {
        btn.style.left = str;
        if (str == "2.5%")
          str = "0%";
        else
          str = "2.5%"

        const menu = btn.closest('.menu');
        
        const caret = menu.querySelector('.caret');
        caret.classList.toggle('caret-rotate');

        const submenu = menu.querySelector('.submenu');
        submenu.classList.toggle('submenu-open');
    }
  </script>
</html>